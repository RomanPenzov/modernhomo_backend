# üìò –ü—Ä–æ–µ–∫—Ç: ModernHomo Backend

## üß† –û–ø–∏—Å–∞–Ω–∏–µ

ModernHomo ‚Äî backend-—Å–µ—Ä–≤–∏—Å, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –Ω–∞ FastAPI, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:

* —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π,
* –¥–µ—Ç–µ–∫—Ü–∏—é –æ–ø–∞—Å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏–ª–∏ —Å–ª–æ–≤ (Danger Events),
* —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é —Ä–µ—á–∏,
* –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ "–∏–Ω–¥–µ–∫—Å–∞ —Å—á–∞—Å—Ç—å—è" –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞ (NLP-–º–æ–¥–µ–ª—å).

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º–∏ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PostgreSQL —á–µ—Ä–µ–∑ Alembic –∏ Docker Compose.

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* Python 3.10
* FastAPI
* PostgreSQL
* SQLAlchemy + Alembic
* Docker + Docker Compose
* Pydantic v2
* PyJWT
* HuggingFace Transformers (NLP)
* Pytest + TestClient

---

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
modernhomo_backend/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/               # –†–æ—É—Ç–µ—Ä—ã FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ core/              # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ crud/              # CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ models/            # SQLAlchemy-–º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ schemas/           # Pydantic-—Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ services/          # –õ–æ–≥–∏–∫–∞ NLP (–∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞)
‚îÇ   ‚îî‚îÄ‚îÄ main.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ tests/                 # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ migrations/            # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docker-compose.yml     # –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker
‚îú‚îÄ‚îÄ Dockerfile             # Backend –æ–±—Ä–∞–∑
‚îî‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### üîß 1. –ö–ª–æ–Ω–∏—Ä—É–π –∏ –ø–µ—Ä–µ–π–¥–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞

```bash
git clone <repo-url>
cd modernhomo_backend
```

### üê≥ 2. –ó–∞–ø—É—Å—Ç–∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Docker Compose

```bash
docker-compose up -d
```

### üì¶ 3. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏

```bash
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt
```

### ‚öôÔ∏è 4. –í—ã–ø–æ–ª–Ω–∏ Alembic –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
alembic upgrade head
```

### ‚ñ∂Ô∏è 5. –ó–∞–ø—É—Å—Ç–∏ FastAPI

```bash
uvicorn app.main:app --reload --port 8001
```

### üß™ 6. –ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç—ã

```bash
$env:PYTHONPATH = "."
pytest
```

---

## üìã API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (Swagger: [http://127.0.0.1:8001/docs](http://127.0.0.1:8001/docs))

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å              | –û–ø–∏—Å–∞–Ω–∏–µ                                            |
| ----- | ----------------- | --------------------------------------------------- |
| POST  | /users/register   | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                            |
| POST  | /users/login      | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞                   |
| GET   | /danger-events/   | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è                   |
| POST  | /danger-events/   | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ                              |
| GET   | /transcriptions/  | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è              |
| POST  | /transcriptions/  | –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—é                               |
| POST  | /happiness-index/ | –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ (—ç–º–æ—Ü–∏–∏: positive, neutral, negative) |

---

## ü§ñ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

–ú–æ–¥–µ–ª—å –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ–∫—Å—Ç–∞ (`blanchefort/rubert-base-cased-sentiment`) –∏–∑ HuggingFace:

* –ø–æ–ª—É—á–∞–µ—Ç —Ñ—Ä–∞–∑—É,
* –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ–∫—Ä–∞—Å–∫—É: `positive`, `neutral` –∏–ª–∏ `negative`,
* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `/happiness-index/` –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∞ –¥–ª—è –¥–Ω–µ–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ –≤—Å–µ–º —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è–º.

---

## üé• –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –≤–∏–¥–µ–æ (–¥–æ 7 –º–∏–Ω—É—Ç)

### üü¢ –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ:

> –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, —è —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª backend –Ω–∞ FastAPI ‚Äî —ç—Ç–æ —Å–µ—Ä–≤–∏—Å ModernHomo, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é, –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–±—ã—Ç–∏–π, —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ —Ä–µ—á–∏ –∏ –∞–Ω–∞–ª–∏–∑ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å –ø–æ–º–æ—â—å—é –Ω–µ–π—Ä–æ—Å–µ—Ç–∏.

### üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

> –£ –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã: `User`, `DangerEvent`, `Transcription`. –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Alembic.

### üß™ CRUD –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:

> –Ø –ø–æ–∫–∞–∂—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ª–æ–≥–∏–Ω, –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º `/danger-events` –∏ `/transcriptions` —á–µ—Ä–µ–∑ Swagger UI.

### üß† –ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞:

> –¢–∞–∫–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–∞—Ä—à—Ä—É—Ç `/happiness-index/`, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ–∫—Ä–∞—Å–∫—É —Ç–µ–∫—Å—Ç–∞. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—É—é –Ω–µ–π—Ä–æ—Å–µ—Ç—å –Ω–∞ HuggingFace. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ—Ä–∞–∑–∞ ¬´—è —Ä–∞–¥¬ª –≤–µ—Ä–Ω—ë—Ç `positive`.

### ‚úÖ –¢–µ—Å—Ç—ã:

> –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∫—Ä—ã—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ç–µ—Å—Ç–∞–º–∏: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, —Å–æ–±—ã—Ç–∏—è, —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞. –ü–æ–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ pytest –∏ TestClient.

### üê≥ –ó–∞–ø—É—Å–∫:

> –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Docker Compose, —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PostgreSQL, –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è Alembic, –∞ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ ‚Äî —á–µ—Ä–µ–∑ uvicorn.

### üéØ –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ:

> –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä–æ–µ–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, API, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –º–∏–≥—Ä–∞—Ü–∏–∏, —Ç–µ—Å—Ç—ã. –°–ø–∞—Å–∏–±–æ!

---

## ‚úÖ –ê–≤—Ç–æ—Ä: \[–¢–≤–æ—ë –∏–º—è]

–ì–æ—Ç–æ–≤–æ –∫ —Å–¥–∞—á–µ üéì
